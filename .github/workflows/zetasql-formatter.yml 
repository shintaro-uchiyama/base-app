name: ZetaSQL Formatter
on:
  push:
    branches: [master]

jobs:
  format:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Format queries
        run: |
          wget https://github.com/Matts966/zetasql-formatter/releases/latest/download/zetasql-formatter_linux_x86_64.zip \
            && sudo unzip zetasql-formatter_linux_x86_64.zip -d /usr/local/bin
          zetasql-formatter . || true
          rm zetasql-formatter_linux_x86_64.zip
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v3
        with:
          commit-message: Format queries
          reviewers: Matts966
          branch: zetasql-formatter
          delete-branch: true
          title: 'Apply zetasql-formatter'
          body: |
            Applied zetasql-formatter :tada:
            Auto-generated by [create-pull-request][1]
            [1]: https://github.com/peter-evans/create-pull-request